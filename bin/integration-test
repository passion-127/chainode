#!/bin/bash
# Bash script to execute integration tests

# Docker compose custom wrapper for test environment
function docker-test-env {
  docker-compose -f network.yml -f nats.yml -f mongodb.yml -f monitoring.yml -f dev-app.yml integration-tests.yml $@
}

# Start test environment
echo -e "Starting dockerized environment."
cd docker-compose/
docker-test-env up -d
sleep 2

# Execute integration tests
docker exec -it nodejs npm test
echo -e "Completed all integration tests."

# Stop the test environment
docker-test-env down
cd ../
echo -e "Shutdown of dockerized environment."
